\subsection{Retrieval \& reconstruction techniques\label{sec:recon-techniques-intro}}
% \& analysis methodologies

% Very generally, the problem of retrieval can be considered in terms of completeness, i.e. the degree to which the full quantum state of the system is know. In photoionization, ``complete" experiments, in which the full system wavefunction (matrix elements), denote the class of measurements in which full matrix element retrieval is the goal, as distinct from measurements which aim at specific observables
% This is currently briefly in Sect. 3.1, but probably should be expanded!

Following the tensor notation presented above, a ``complete" photoionization experiment can be characterized as recovery of the matrix elements $I^{\zeta}(\epsilon)$ from the experimental measurements or, equivalently, the density matrix $\mathbf{\rho}^{\zeta\zeta'}$. (For further discussion, see refs. \cite{Reid2003,kleinpoppen2013perfect,hockett2018QMP1}.) This may be possible provided the channel functions are known, and the information content of the measurements is sufficient. (Note here that the matrix elements are assumed to be time-independent, although that may not be the case for the most complicated examples including vibronic dynamics \cite{hockett2018QMP2}.) 

Additionally, for schemes making use of molecular alignment, the molecular axis distributions must also be characterised. For the rotational wavepacket case, this is discussed in Sect. \ref{sec:RWPs}; this can actually be considered as a reduced-dimensionality MF signal retrieval problem, and also forms the first step in both the generalised ``bootstrapping" method (Sect. \ref{sec:bootstrapping}) and matrix inversion techniques (Sect. \ref{sec:matrix-inv-intro}).

Of particular import for matrix element retrieval is the phase-sensitive nature of the observables, which is required in order to obtain partial wave phase information - hence PADs can also be considered as angular interferograms, and reconstruction can be considered conceptually similar to other phase-retrieval problems, e.g. optical field recovery with techniques such as FROG \cite{trebino2000FrequencyResolvedOpticalGating}, and general quantum tomography \cite{MauroDAriano2003}. 



\subsubsection{Freely rotating molecules: MF via time evolution\label{sec:RWPs}}
% PH 22/08/22 - move this from 4.1.2 to 4.3.1, and added final paras to consolidate - may need some work still!

The efforts to align and orient molecules discussed in the previous sections necessarily led to detailed studies of the rotational dynamics of molecules after interaction with a non-resonant femtosecond laser pulse. A significant outcome of these studies has been the development of a reliable model capable of accurate simulations of rotational wavepacket dynamics that quantitatively agree with experimental results. By measurement of a signal from a time evolving rotational wavepacket, this ability to accurately simulate the wavepacket dynamics can be used to reconstruct the measured signal in the molecular frame. Since in this case the time resolved measurement constitutes a set of measurements of the same quantity from a variety of molecular axes distributions, it is reasonable to conclude that if the axes distributions are known, and provided a large enough space of orientations is explored by the molecule over the experimental time window, the molecular frame signal should be extractable. 

This is relatively straight forward for a signal that is a single number (scalar) in the MF for a given polarization of the light, such as the photoionisation yield. Such a signal may, in general, be expressed as an expansion,
\begin{equation}
S(\theta,\chi)=\sum_{jk}C_{jk}D^{j}_{0k}(\theta,\chi),
\label{eq:mfrealsig}
\end{equation}
where $\theta$ and $\chi$ are the spherical polar and azimuthal angles of the linearly polarized electroic field vector generating the signal; $C_{jk}$ are unknown expansion coefficients; and $D^{j}_{0k}$ are the Wigner D-Matrix elements, a basis on the space of orientations. A time resolved measurement of $S$ from a rotational wavepacket is the quantum expectation value of this expression,
\begin{equation}
\langle S \rangle(t) = \sum_{jk}C_{jk}\langle D^{j}_{0k} \rangle (t).
\label{eq:St-Cjk}
\end{equation}
Since the rotational wavepacket can be accurately simulated, the $\langle D^{j}_{0k} \rangle (t)$ are considered known. The time resolved signal $\langle S \rangle(t)$ being measured, the unknown coefficients $C_{jk}$ can be determined by linear regression (albeit overdetermined), and the molecular frame signal in Eq.~\ref{eq:mfrealsig} constructed. In this form the method was initially applied to strong field ionization and dubbed Orientation Reconstruction through Rotational Coherence Spectroscopy (ORRCS). It has since been applied to strong field ionization of various molecules, strong field dissociation and few-photon ionization.

% The case of PADs is a more challenging one, since they are not generally described by Eq.~\ref{eq:mfrealsig}. Instead, both LFPADs and MFPADs are determined by the radial dipole matrix elements as described above (\textbf{refer to section 3 here!}). The authors of this manuscript, with a number of collaborators, demonstrated that these matrix elements can also be retrieved for one-photon ionisation of N$_2$ by time resolved measurements of LFPADs from a rotational wavepacket. This method is focus of sections X and Y (\textbf{refer to apprpriate section(s)!}) below, with additional details and results provided on the case of radial matrix element extraction for N$_2$.   In follow up work, it was shown that for molecules with $D_{nh}$ point group symmetry the retrieval of the MFPAD is possible directly, bypassing the radial matrix elements. 

The case of PADs is a more challenging one, since they are not generally described by Eq.~\ref{eq:mfrealsig}. Instead, both LFPADs and MFPADs are determined by the radial dipole matrix elements as described above (Sects. \ref{sec:dynamics-intro}, \ref{sec:channel-funcs}). However, the correspondence of the problem with an equation of the form of Eqn. \ref{eq:St-Cjk} - essentially a convolution - can be made. This is discussed in detail in Ref. \cite{Underwood2000}; in the current case Eqns. \ref{eqn:channel-fns}, \ref{eq:BLM-tensor-AF} can be rewritten in a similar form to Eqn. \ref{eq:St-Cjk} by explicitly separating out the axis distribution moments $A_{Q,S}^{K}(t)$ and collapsing all other terms. The case of photoionization from a time-dependent ensemble can then be reparametrized as:
% (cf. also Eqn. \ref{eq:BLM-tensor-AF}):

% \begin{equation}
% \beta_{L,M}^{u}(t)=\sum_{K,Q,S}(\sum_{\zeta,\zeta'}\bar{\varUpsilon}_{L,M}^{u,\zeta\zeta'}\mathbb{I}^{\zeta\zeta'})A_{Q,S}^{K}(t)

% \label{eqn:beta-convolution}
% \end{equation}

% Where $\bar{\varUpsilon}$ is as per Eqn. \ref{eqn:channel-fns} except for the omission of the ADMs. 
% and the case of photoionization from a time-dependent ensemble can be reparametrized as:

\begin{equation}
\bar{\beta}_{L,M}^{u}(\epsilon,t)=\sum_{K,Q,S}\bar{C}_{KQS}^{LM}(\epsilon)A_{Q,S}^{K}(t)
\label{eqn:beta-convolution-C}
\end{equation}

% [NOTE: this now preempts the matrix inversion formalism, so may want to change this, or that, to avoid repetition] UPDATE - now fixed notation and refer to that eqn instead of duplicating.

Here the set of axis distribution moments can thus be viewed as modulating all observables $\beta_{L,M}^{u}(t)$; the unknowns $\bar{C}_{KQS}^{LM}$ and axis distribution moments $A_{Q,S}^{K}(t)$, can be retrieved in a similar manner to that discussed for the simpler scalar observable case above, i.e. via linear regression with simulated rotational wavepackets. 

In practice this equates to (accurately) simulating rotational wavepackets, hence obtaining the corresponding $A_{Q,S}^{K}(t)$ parameters (expectation values), as a function of laser fluence and rotational temperature. Given experimental data, a 2D uncertainty (or error) surface in these two fundamental quantities can then be obtained from a linear regression for each set of $A_{Q,S}^{K}(t)$. The closest set of parameters to the experimental case is then determined by selection of the best results (smallest uncertainty) from such a parameter-space mapping, which constitutes determination of both the rotational wavepcket (hence $A_{Q,S}^{K}(t)$) and $\bar{C}_{KQS}^{LM}(\epsilon)$; optimally, the corresponding physical properties can be cross-checked with other experimental estimates for additional confirmation of the fiedelity of the protocol, although this may not always be possible. Note that, in this case, the photoionization dynamics are phenomenologically described by the real parameters $\bar{C}_{KQS}^{LM}$, but details of the matrix elements are not obtained directly; however, these parameters can be further used for the matrix inversion method (Sect. \ref{sec:matrix-inv-intro}), and are formally defined therein (Eqn. \ref{eq:C-AF}).

% 22/08/22 - removed this for now, but could incorporated into Sect 4.1.1
% The authors of this manuscript, with a number of collaborators, demonstrated that these matrix elements can also be retrieved for one-photon ionisation of N$_2$ by time resolved measurements of LFPADs from a rotational wavepacket. This method is focus of sections X and Y (\textbf{refer to apprpriate section(s)!}) below, with additional details and results provided on the case of radial matrix element extraction for N$_2$.   In follow up work, it was shown that for molecules with $D_{nh}$ point group symmetry the retrieval of the MFPAD is possible directly, bypassing the radial matrix elements. 





\subsubsection{Fitting methodologies\label{sec:fitting-intro}}

The nature of the photoionization problem suggests that a fitting approach can work, in general, which can be expressed (for example) in the standard way as a (non-linear) least-squares minimization problem:

\begin{equation}
\chi^{2}(\mathbb{I}^{\zeta\zeta'})=\sum_{u}\left[\beta^{u}_{L,M}(\epsilon,t;\mathbb{I}^{\zeta\zeta'})-\beta^{u}_{L,M}(\epsilon,t)\right]^{2}\label{eq:chi2-I}
\end{equation}

Where $\beta^{u}_{L,M}(\epsilon,t;\mathbb{I}^{\zeta\zeta'})$ denotes  the values from a model function, computed for a given set of (complex) matrix elements $\mathbb{I}^{\zeta\zeta'}$, and $\beta^{u}_{L,M}(\epsilon,t)$ the experimentally-measured parameters, for a given configuration $u$. Implicit in the notation is that the matrix elements are independent of $u$ (or otherwise averaged over $u$). Once the matrix elements are obtained in this manner then MF observables, for any arbitrary $u$, can be calculated. An example of such a protocol - specifically one based on time-domain measurements and making use of a rotational wavepacket - is shown in Fig. \ref{781808}, %, as previously discussed, 
and the practical realisation of such a methodology is the topic of Sect. \ref{sec:bootstrapping} (see also refs. \cite{hockett2018QMP2, marceau2017MolecularFrameReconstruction} for further discussion). As discussed in Sect. \ref{sec:MF-recon-expt}, other choices of experimental measurements may also be made, for instance direct MF measurements or frequency-domain measurements, some representative examples from the literature are given in Sect. \ref{sec:CompleteLit}. 
% [23/08/22 HERE - move to expt section? Also intro complete expts better elsewhere?]

Although in principle a very general approach, outstanding questions with such protocols remain, in particular fit uniqueness and reproducibility, the optimal measurement space $u$ - or associated information content $M_u$ - for any given case or measurement schema, and how well they will scale to larger problems (more matrix elements/partial waves). (Again, see refs. \cite{hockett2018QMP2, marceau2017MolecularFrameReconstruction} for further discussion.)


\subsubsection{Matrix inversion methodologies\label{sec:matrix-inv-intro}}

An alternative methodology has recently been demonstrated, in which the MF observables are determined via a matrix inversion protocol \cite{gregory2021MolecularFramePhotoelectron}. This method does not require - potentially time-consuming - numerical fitting, although still requires knowledge of the channel functions. A full outline of the matrix inversion method is given in Appendix \ref{app:mat-inversion}, and a brief overview below.

For the matrix-inversion approach, the relationship between the LF/AF and MF is considered in terms of a matrix transform:

\begin{equation}
\mathbf{C}^{mol}=\mathbf{G}\mathbf{C}^{lab},\label{eq:basic}
\end{equation}

Where $\mathbf{C}$ are a set of coefficients that can be used to construct the $\beta_{LM}$ in the LF and MF. Explicitly, 

%similar to the channel functions defined above, but \textit{without} the inclusion of alignment ($\mathbf{C}^{lab}$) or frame rotation effects ($\mathbf{C}^{mol}$), and will be termed herein as ``reduced" channel functions. The relevant parameters can be explicitly defined as:

\begin{equation}
C_{PR}^{LM}(\epsilon,\Delta q)=\sum_{\zeta\zeta'}\mathbb{I}^{\zeta\zeta'}(\epsilon)\Gamma_{PR\Delta q}^{\zeta\zeta'LM}
\end{equation}

for the MF ($\mathbf{C}^{mol}$), and:

\begin{equation}
\bar{C}_{KQS}^{LM}(\epsilon)=\sum_{\zeta\zeta'}\mathbb{I}^{\zeta\zeta'}(\epsilon)\Gamma_{KQS}^{\zeta\zeta'LM}
\label{eq:C-AF}
\end{equation}

for the LF ($\mathbf{C}^{lab}$). We refer to $\mathbf{\Gamma}$ as the ``reduced" channel functions - similar to the channel functions defined previously (Sect. \ref{sec:channel-funcs}), but \textit{without} the inclusion of alignment ($\mathbf{C}^{lab}$) or frame rotation effects ($\mathbf{C}^{mol}$). These are explicitly indexed by all required quantum numbers for the LF and MF definitions (as previously, $\zeta$ denotes all other required indices). Again, full details can be found in Appendix \ref{app:mat-inversion}. Given these, it can be shown for molecules with $D_{nh}$ point group symmetry that a transformation matrix can be written as:

\begin{equation}
\mathbf{G}_{L'M'KS}^{LMP\Delta q}=\mathbf{\Gamma}_{P0\Delta q}^{\zeta\zeta'LM}(\mathbf{\Gamma}_{K0S}^{\zeta\zeta'L^{\prime}M^{\prime}})^{+}
\label{eq:MPinversion}
\end{equation}

Here $()^{+}$ indicates the Moore-Penrose inverse matrix of a reduced channel function, which can be computed numerically. Significantly, the matrix elements are not required for inversion, provided that $\mathbf{C}^{lab}$ is known (e.g. from a measurement), and that the reduced channel functions are computed. Therefore, this method does not provide a route to reconstruction of a full set of matrix elements, but can be used to obtain MFPADs, and has been demonstrated to work for linear ($N_2$, $D_{\infty h}$ symmetry) and 
%\textbf{asymmetric top}
asymmetric top ($C_{2}H_{4}$, $D_{2h}$ symmetry) examples. Although not as powerful as a complete experiment methodology, this technique is expected to scale more readily to larger problems (more matrix elements), for which a complete matrix element retrieval via fitting may be impossible. 


\subsubsection{Numerical implementations\label{sec:numerics-intro}}

The numerical implementation of the methodologies defined above has been variously implemented in the past, including code in Fortran, C and Matlab, often for specific cases only. Recently a unified Python codebase/ecosystem/platform has been in development to tackle various aspects of photoionization problems, including \textit{ab initio} computations and experimental data handling, and (generalised) matrix element retrieval. The ``Quantum Metrology with Photoelectrons"  platform is briefly introduced here, and is used for the analysis in Sects. \ref{sec:bootstrapping} and \ref{sec:recon-from-MFPADs}. Fig. \ref{239231} shows some of the main tools and tasks/layers. 
% The main software components are detailed further below (see also Sects. \ref{sec:resources}, \ref{sec:numerical-notes}).

The two main components of the platform used herein are:
% (see also Sects. \ref{sec:resources} for more tools, and \ref{sec:numerical-notes} for additional implementation details):

\begin{itemize}
\item The Photoelectron Metrology Toolkit (PEMtk) codebase \cite{hockett2021PEMtkDocs, hockett2021PEMtkGithub} aims to provide various general data handling routines for photoionization problems. At the time of writing, simulation of observables and fitting routines are implemented, along with some basic utility functions. Further implementation details can be found in Sect. \ref{sec:numerical-notes}, and the \href{https://pemtk.readthedocs.io/en/latest/about.html}{PEMtk documentation} \cite{hockett2021PEMtkDocs}.
\item The ePSproc codebase \cite{ePSprocAuthorea, ePSprocGithub, ePSprocDocs} aims to provide methods for post-processing with \textit{ab initio} radial dipole matrix elements from ePolyScat \cite{Lucchese1986, Gianturco1994, Natalense1999, luccheseEPolyScatUserManual}, or equivalent matrix elements from other sources, including computation of AF and MF observables. Manual computation without known matrix elements is also possible, e.g. for investigating limiting cases, or data analysis and fitting. These routines also provide the backend functionality for PEMtk fitting routines. See Sect. \ref{sec:numerical-notes} for additional notes.
\end{itemize}

Note that, at the time of writing, rotational wavepacket simulation is not yet implemented in the PEMtk suite, and these must be obtained via other codes. %The example wavepacket used in Sect. \ref{sec:bootstrapping}

A Docker-based distribution of various codes for tackling photoionization problems is also available from the \href{https://github.com/phockett/open-photoionization-docker-stacks}{Open Photoionization Docker Stacks} project, which aims to make a range of these tools more accessible to interested researchers \cite{hockettOpenPhotoionizationDocker}.



% Additional aspects of the platform:

% \begin{itemize}
% \item ePSdata \cite{hockett2019EPSDataPhotoionization}
% \end{itemize}



% The PEMtk python package [REF] currently implements the bootstrapping routines, and full computational notebooks, including source data and numerics, for these examples are available online [REFS]. The matrix inversion technique will be implemented soon, examples shown herein are reproduced from ref. \cite{gregory2021MolecularFramePhotoelectron}. It is hoped that interested readers will make use of these materials, and that this presentation will encourage other readers to try (and build upon) what has - up until quite recently - been a rather challenging and involved numerical analysis task.

% - General notes on fitting? Some already below, and may stay there.
% - Matrix inversion method overview?