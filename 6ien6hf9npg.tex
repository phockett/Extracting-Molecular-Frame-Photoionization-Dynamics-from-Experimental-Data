% \subsection{Theoretical techniques \& analysis methodologies\label{sec:theoretical-techniques}}

\subsection{Theoretical techniques\label{sec:theoretical-techniques}}

% To cover 

% \begin{itemize}
% \item Theory sophistication and availability
% \item Data analysis techniques
% \item Development of new formalism/theory, relation to phase retrieval problems, etc.
% \end{itemize}

\subsubsection{Tensor formulation of photoionization\label{sec:tensor-formulation}}

A number of authors have treated MFPADs and related problems, see Appendix \ref{sec:theory-lit} for some examples. Herein, a geometric tensor based formalism is developed, which is close in spirit to the treatments given by Underwood and co-workers \cite{Reid2000, Stolow2008, Underwood2000}, but further separates various sets of physical parameters into dedicated tensors. This allows for a unified theoretical and numerical treatment, where the latter computes properties as tensor variables which can be further manipulated and investigated. %\footnote{It should be emphasized, however, that the underlying physical quantities are essentially identical in all these approaches, with a set of coupled angular-momenta defining the geometrical part of the photoionization problem, despite these differences in the details of the theory and notation. The current tensorial numerical implementation is in contradistinction to standard numerical routines in which the requisite terms are usually computed from vectorial and/or nested summations, which can be somewhat opaque to detailed interpretation, and typically implement the full computation of the observables in one computational routine. The main cost of a tensor-based approach is that more RAM is required to store the full set of tensor variables.} 
Furthermore, the tensors can readily be converted to a density matrix representation \cite{BlumDensityMat, zareAngMom}, which is more natural for some quantities, and also emphasizes the link to quantum state tomography and other quantum information techniques. Much of the theoretical background, as well as application to aspects of the current problem, can be found in the textbooks of Blum \cite{BlumDensityMat} and Zare \cite{zareAngMom}.

Within this treatment, the observables can be defined in a series of simplified forms, emphasizing the quantities of interest for a given problem. Some details are defined in the following subsections, and further detailed in Appendix \ref{appendix:formalism}.


\subsubsection{Channel functions\label{sec:channel-funcs}}

% 07/03/23 - added longer lead-in here, may also want to add notes on fitting?
A simple form of the equations, amenable to fitting, is to write the observables in terms of ``channel functions", which define the ionization continuum for a given case and set of parameters $u$ (e.g. defined for the MF, or defined for a specific experimental configuration). Here we briefly introduce the notation, which expresses the observables $\beta_{L,M}^{u}$ (Eq. \ref{eq:AF-PAD-general}) as a tensor product of channel functions ($\varUpsilon_{L,M}^{u,\zeta\zeta'}$), which collect all of the geometric parameters, and ionization matrix elements $\mathbb{I}^{\zeta\zeta'}$. At a basic level, the channel functions can be viewed simply as defining all of the analytical parameters in a given case; further theoretical details are unpacked below (Sect. \ref{sec:full-tensor-expansion} and Appendix \ref{appendix:formalism}), and specific cases in Sect. \ref{sec:bootstrapping-info-sensitivity}.

Making use of the channel functions, the observables can be written as:

\begin{equation}
\beta_{L,M}^{u}=\sum_{\zeta,\zeta'}\varUpsilon_{L,M}^{u,\zeta\zeta'}\mathbb{I}^{\zeta\zeta'}\label{eqn:channel-fns}
\end{equation}

% \sum_{\zeta,\zeta'}\varUpsilon_{L,M}^{u,\zeta\zeta'}\mathbb{I}_{\zeta\zeta'}^{\Gamma,\Gamma'}=
% \equiv\sum_{\zeta,\zeta'}\varUpsilon_{L,M}^{u,\zeta\zeta'}\mathbf{\rho}^{\zeta\zeta'}

where $\zeta,\zeta'$ collect all the required quantum numbers, and define all (coherent) pairs of components. The term $\mathbb{I}^{\zeta\zeta'}$ denotes the coherent square of the ionization matrix elements:

\begin{equation}
\mathbb{I}^{\zeta,\zeta}=I^{\zeta}(\epsilon)I^{\zeta'*}(\epsilon)
\label{eqn:I-zeta}
\end{equation}

This is effectively a convolution equation (cf. refs. \cite{Reid2000,gregory2021MolecularFramePhotoelectron}) with channel functions, for a given ``experiment'' $u$, summed over all terms $\zeta,\zeta'$. Aside from the change in notation (which is here chosen to match the formalism of Refs. \cite{Gianturco1994, Lucchese1986, Natalense1999}), see also Sect. \ref{sec:mat-ele-conventions}), these matrix elements are essentially identical to the simplified (radial) forms $\mathbf{r}_{k,l,m}$ defined in Eqn. \ref{eq:r-kllam}, in the case where $\zeta=k,l,m$. These complex matrix elements can also be equivalently defined in a magnitude, phase form:

\begin{equation}
I^{\zeta}(\epsilon)\equiv\mathbf{r}_{\zeta}\equiv r_{\zeta}e^{i\phi_{\zeta}}
\end{equation}


This tensorial form is numerically implemented in the ePSproc codebase \cite{ePSprocGithub}. This is in contradistinction to standard numerical routines in which the requisite terms are usually computed from vectorial and/or nested summations, and typically implement the full computation of the observables in one computational routine. The standard approach can be somewhat opaque to detailed interpretation.  The PEMtk codebase \cite{hockett2021PEMtkGithub} implements matrix element retrieval based on this formalism, with pre-computation of all the geometric tensor components (channel functions) prior to a fitting protocol for matrix element analysis. This is essentially a fit to Eqn. \ref{eqn:channel-fns} given a set of $\beta_{L,M}^{u}$, with $I^{\zeta}(\epsilon)$ as the unknowns (in magnitude, phase form). The main computational cost of a tensor-based approach is that more RAM is required to store the full set of tensor variables.

\subsubsection{Density matrix representation\label{sec:density-mat-basic}}
The density operator associated with the continuum state in Eq.~\ref{eq:cstate} is easily written as $\hat{\rho}=|\Psi_c\rangle\langle\Psi_c|$. In the channel function basis, this leads to a density matrix given by the radial matrix elements:

\begin{equation}
\mathbf{\rho}^{\zeta\zeta'} = \mathbb{I}^{\zeta,\zeta'}
\label{eqn:radial-density-mat}
\end{equation}

Since the matrix elements characterise the scattering event, the density matrix provides an equivalent characterisation of the scattering event.
An example case is discussed in Sect. \ref{sec:den-mat-N2} (see Fig. \ref{998904}); for more details, and further discussion, see Sect. \ref{sec:density-mat-full}. Further discussion can also be found in the literature, see, e.g., Ref. \cite{BlumDensityMat} for general discussion, Ref. \cite{Reid1991} for application in pump-probe schemes.

% \textbf{I don't think I fully understand this section. In the partial wave basis, wouldn't the density operator be,}
% \begin{equation}
% \rho(t) =\sum_{LM}\sum_{KQS}A^{K}_{QS}(t)\sum_{\zeta\zeta^{\prime}}\Gamma^{\zeta\zeta^{\prime}LM}_{KQS}|\zeta,\Psi_+\rangle\langle\zeta,\Psi_+|\mu_q\rho_i\mu_{q\prime}^{*}|\zeta^{\prime},\Psi_+\rangle\langle\zeta^{\prime},\Psi_+|
% \end{equation}
% \textbf{with} $\rho_i = |\Psi_i\rangle\langle\Psi_i|$\textbf{ ? It's likely I'm not fully understanding the notation here, because I'm used the notation in MG 2021. Either way, maybe we don't need to include the density matrix version here? Eq.~\ref{eq:cstate} is intended to drive home the quantum tomography perspective.}\\
% Following the channel function notation, it is also trivial to write the radial matrix elements in density matrix form in the $\zeta\zeta'$ representation:

% \begin{equation}
% \mathbf{\rho}^{\zeta\zeta'} = |\zeta\rangle\langle\zeta'| \equiv \mathbb{I}^{\zeta,\zeta'}\label{eqn:radial-density-mat}
% \end{equation}

% And the full final continuum state as a density matrix in the $\zeta\zeta'$ representation (with the observable dimensions $L,M$ explicitly included in the density matrix), which will also be dependent on the choice of channel functions ($u$):

% \begin{equation}
% \mathbf{\rho}_{L,M}^{u,\zeta\zeta'}=\varUpsilon_{L,M}^{u,\zeta\zeta'}\mathbb{I}^{\zeta,\zeta'}
% \end{equation}

% Here the density matrix can be interpreted as the final, LF/AF or
% MF density matrix (depending on the channel functions used), incorporating both the intrinsic and extrinsic
% effects (i.e. all channel couplings and radial matrix elements for
% the given measurement), with dimensions dependent on the unique sets of quantum numbers required - in the simplest case, this will just be a set of partial waves $\zeta = (l,m)$. Note that this final state is distinct from the ``radial" density matrix (Eqn. \ref{eqn:radial-density-mat}), which encodes purely intrinsic (molecular scattering) photoionization dynamics. The $L,M$ notation indicates here that these dimensions should not be summed over, hence the tensor coupling into the $\beta_{L,M}^{u}$ parameters can also be written in terms of the density matrix:

% \begin{equation}
% \beta_{L,M}^{u}=\sum_{\zeta,\zeta'}\mathbf{\rho}_{L,M}^{u,\zeta\zeta'}
% \end{equation}

% In fact, this form arises naturally since the $\beta_{L,M}^{u}$ terms are the state multipoles (geometric tensors) defining the system, which can be thought of as a coupled basis equivalent of the density matrix representations (see, e.g., ref. \cite{BlumDensityMat}, Chpt. 4.).

% TODO: confirm notation here, may want to include more discussion from Blum? (See Fig. \ref{998904} for results, should also confirm representation here from outer product case, maybe plot LM representation too - see \href{https://epsproc.readthedocs.io/en/dev/methods/density_mat_notes_demo_300821.html}{ePSproc density matrix notes} esp. \href{https://epsproc.readthedocs.io/en/dev/methods/density_mat_notes_demo_300821.html#Density-matrix-from-geometric-tensors}{Density matrix from geometric tensors section}.)



\subsubsection{Full tensor expansion\label{sec:full-tensor-expansion}}

In more detail, the channel functions can be given as a set of tensors, defining each aspect of the problem.

For the MF:

\begin{eqnarray}
\beta_{L,-M}^{\mu_{i},\mu_{f}}(\epsilon) & = & (-1)^{M}\sum_{P,R',R}(2P+1)^{\frac{1}{2}}{E_{P-R}(\hat{e};\mu_{0})}\\
 & \times &\sum_{l,m,\mu}\sum_{l',m',\mu'}(-1)^{(\mu'-\mu_{0})}{\Lambda_{R',R}(R_{\hat{n}};\mu,P,R,R')B_{L,-M}(l,l',m,m')}\\
 & \times & I_{l,m,\mu}^{p_{i}\mu_{i},p_{f}\mu_{f}}(\epsilon)I_{l',m',\mu'}^{p_{i}\mu_{i},p_{f}\mu_{f}*}(\epsilon)\label{eq:BLM-tensor-MF}
\end{eqnarray}

And the LF/AF as:

\begin{eqnarray}
\bar{\beta}_{L,-M}^{\mu_{i},\mu_{f}}(E,t) & = & (-1)^{M}\sum_{P,R',R}{[P]^{\frac{1}{2}}}{E_{P-R}(\hat{e};\mu_{0})}\\
 & \times &\sum_{l,m,\mu}\sum_{l',m',\mu'}(-1)^{(\mu'-\mu_{0})}{\Lambda_{R'}(\mu,P,R')B_{L,S-R'}(l,l',m,m')}\\
 & \times &I_{l,m,\mu}^{p_{i}\mu_{i},p_{f}\mu_{f}}(\epsilon)I_{l',m',\mu'}^{p_{i}\mu_{i},p_{f}\mu_{f}*}(\epsilon)\sum_{K,Q,S}\Delta_{L,M}(K,Q,S)A_{Q,S}^{K}(t)\label{eq:BLM-tensor-AF}
\end{eqnarray}

In both cases a set of geometric tensor terms are required, which are fully defined in Appendix \ref{appendix:formalism}; these terms provide details of:

\begin{itemize}
\item ${E_{P-R}(\hat{e};\mu_{0})}$: polarization geometry \& coupling with the electric field.
\item $B_{L,S-R'}(l,l',m,m')$: geometric coupling of the partial waves into the $\beta_{L,M}$ terms (spherical tensors).
\item $\Lambda_{R'}(\mu,P,R')$: frame couplings and rotations.
\item $\Delta_{L,M}(K,Q,S)$: alignment frame coupling.
\item $A_{Q,S}^{K}(t)$: ensemble alignment described as a set of axis distribution moments (ADMs).
\end{itemize}

And \(I_{l,m,\mu}^{p_{i}\mu_{i},p_{f}\mu_{f}}(\epsilon)\) are the (radial) dipole ionization matrix elements, as a function of energy \(\epsilon\). These matrix elements are essentially identical to the simplified forms $r_{k,l,m}$ defined in Eqn. \ref{eq:r-kllam}, except with additional indices to label symmetry and polarization components
defined by a set of partial-waves \(\{l,m\}\), for polarization component \(\mu\) (denoting the photon angular momentum components) and channels (symmetries) labelled by initial and final state indexes \({p_{i}\mu_{i},p_{f}\mu_{f}}\). The notation here follows that used by ePolyScat \cite{Gianturco1994, Lucchese1986, Natalense1999}, and these matrix elements again represent the quantities  to be obtained numerically from data analysis, or from an \href{https://epsproc.readthedocs.io/en/latest/ePS_ePSproc_tutorial/ePS_tutorial_080520.html\#Theoretical-background}{ePolyScat (or similar) calculation}. 

Note that, in this case as given, time-dependence arises purely from the \(A_{Q,S}^{K}(t)\) terms in the AF case, and the electric field term currently describes only the photon angular momentum coupling,
although can in principle also describe time-dependent/shaped fields. Similarly, a time-dependent initial state (e.g. a vibrational wavepacket) could also describe a time-dependent MF case.

It should be emphasized, however, that the underlying physical quantities are essentially identical in all the theoretical approaches, with a set of coupled angular-momenta defining the geometrical part of the photoionization problem, despite these differences in the details of the theory and notation. 




\subsubsection{Information content\label{sec:info-content}}

As discussed in ref. \cite{hockett2018QMP2}, the information content of a single observable might be regarded as simply the number of contributing $\beta_{L,M}$ parameters. In set notation:

\begin{equation}
M=\mathrm{n}\{\beta_{L,M}\}
\end{equation}

where $M$ is the information content of the measurement, defined
as $\mathrm{n}\{...\}$ the cardinality (number of elements) of the
set of contributing parameters. A set of measurements, made for some
experimental variable $u$, will then have a total information content:

\begin{equation}
M_{u}=\sum_{u}\mathrm{n}\{\beta_{L,M}^{u}\}
\end{equation}

In the case where a single measurement contains multiple $\beta_{L,M}$, e.g. as a function of energy $\epsilon$ or time $t$, the information content will naturally be larger:

% 06/03/23: tried to clarify (E,t) here a bit, may still need work.
\begin{eqnarray}
M_{u,\epsilon,t} & = & \sum_{u,\epsilon,t}\mathrm{n}\{\beta_{L,M}^{u}(\epsilon,t)\}\\
 & = & M_{u}\times M_{\epsilon,t}
\end{eqnarray}

where the second line pertains if each measurement has the same native
information content $M_{\epsilon,t}$ per energy and time point, independent of any other experimental parameters $u$. It may be that the variable
$\epsilon$ is continuous (e.g. photoelectron energy), but in practice it
will usually be discretized in some fashion by the measurement.

In terms of purely experimental methodologies, a larger $M_{u}$ clearly defines a richer experimental measurement which explores more of the total measurement space spanned by the full set of $\{\beta_{L,M}^{u}(k,t)\}$. However, in this basic definition a larger $M_{u}$ does not necessarily indicate a higher information content for quantum retrieval applications.
The reason for this is simply down to the complexity of the problem
(cf. Eqn. \ref{eqn:channel-fns}), in which many couplings define
the sensitivity of the observable to the underlying system properties
of interest. In this sense, more measurements, and larger $M$, may
only add redundancy, rather than new information.

A more complete accounting of information content would, therefore,
also include the channel couplings, i.e. sensitivity/dependence of the observable to a given system property, in some manner. For the case of a time-dependent measurement, arising from a rotational wavepacket, this can be written as:

\begin{equation}
M_{u}=\mathrm{n}\{\varUpsilon_{L,M}^{u}(\epsilon,t)\}
\end{equation}

In this case, each $(\epsilon,t)$ is treated as an independent measurement with unique information content, although there may be redundancy as a function of $t$ depending on the nature of the rotational wavepacket and channel functions. This is explored further in Sect. \ref{sec:bootstrapping-info-sensitivity}. (Note this is in distinction to previously demonstrated cases where the time-dependence was created from a shaped laser-field, and was integrated over in the measurements, which provided a coherently-multiplexed case, see refs. \cite{hockett2014CompletePhotoionizationExperiments, hockett2015CompletePhotoionizationExperiments,hockett2015CoherentControlPhotoelectron} for details.)




% [Formalism from 
% \href{https://epsproc.readthedocs.io/en/dev/methods/ePSproc_geom_methods_summary_190821-v1-tidy.html}{ePSproc notes}


% Also need to develop language a bit + radial matrix elements > Rlmlam form and tensor.

% Add appendix with definition of each tensor.]

