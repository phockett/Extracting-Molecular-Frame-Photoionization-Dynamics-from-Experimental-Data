\subsection{Bootstrapping to the MF example case}

As detailed elsewhere [TBD/refs], the ``bootstapping" methodology proceeds via a multi-stage fitting protocol to obtain both the AF axis distribution (level 1 of the bootstrap, linear fit), and the photoionization matrix elements (level 2 of the bootstrap, non-linear fit). A schematic overview is given in Figure XX. In the simplest case, this proceeds in a direct manner, and a final set of results are obtained. However, further bootstrapping - in the statistical sense - can also be employed to probe the fidelity of the reconstruction with different samples from the source data (typically sub-sets from the measured time-steps and/or $\beta_{LM}$ parameter sub-sets), to further test the robustness of the results, and estimate uncertainties and/or improve upon them. Some of these possibilities are explored below, and further details may also be found in refs. \cite{hockett2018QMP1,hockett2018QMP2,marceau2017MolecularFrameReconstruction} (and references therein).


\subsubsection{Bootstrapping basics: dataset and setup}

For the example case, synthetic data was used, although the dataset was inspired by ref. \cite{marceau2017MolecularFrameReconstruction}. In that case, experimental results were obtained via a (dual) pump-probe scheme, where the IR pump pulses prepared a rotational wavepacket in $N_2$, and a time-delayed XUV probe pulse ionized the sample. Multiple channels were probed in this manner, for a range of time-delays, to provide a dataset of AF-$\beta_{LM}(E,t)$ parameters. Here the focus is on the photoionization step, information content and further investigation of the retrieval routines; this is facilitated by the following choices and data:

\begin{enumerate}
\item The same rotational wavepacket \& molecular axis distribution as obtained experimentally is assumed. Consequently, the 1st (linear) stage of the bootstrapping protocol is not investigated herein.\footnote{Although this may seem like a drastic omission, in general this stage of the methodology is expected to be quite robust, and this has been demonstrated in various investigations of rotational wavepackets and molecular alignment techniques. [REFS]}
\item To simulate the observables, photoionization matrix elements from ePolyScat \cite{Gianturco1994,Natalense1999} calculations are used [REFS: N2 ePSdata]. This, naturally, also provides a means for direct comparison and fidelity analysis of the retrieval protocol.
\item To investigate limitations of the numerical routines, noise and other artefacts can be added to the simulated data; different sub-sets of the data can also be readily analysed and compared.
\item Finally, it is of note that the numerical implementations are structured as a set of tensors, as close as possible to the formalism given above [TODO]. This provides a means to further investigate the information content of various parts of the problem, and investigate their influence on the retrieval - in particular, these can indicate aspects of the data which may be most sensitive to particular matrix elements, most susceptible to noise and so forth.
\end{enumerate}

The sample dataset is illustrated in Figure XX and, as mentioned previously, full numerical data can be accessed online [REF].

\subsubsection{Bootstrapping basics: 10-point fit}

As an initial test of the method, noise-free data was used, and 10 temporal points over the main revival feature were randomly selected. To fit the data, a set of fitting parameters were defined in (magnitude, phase) form. In this case, the parameter set was simply defined from the input matrix elements, including symmetry relations; in general this step in the protocol may require manual configuration for the problem at hand [MORE ON THIS? MATRIX METHOD TOO]. The PEMtk fitting matrix element fitting routine wraps the lmfit package [REF, https://lmfit.github.io/lmfit-py/, https://dx.doi.org/10.5281/zenodo.11813], in this case a standard Levenberg-Marquardt minimization was used, and all parameters allowed to float freely. To gain insight into the efficiency of the fitting routine, and the uniqueness of the fit results [REF], 1000 fits were performed on the same dataset, each seeded with randomised parameter values. (This methodology amounts to a statistical sampling of the solution hyperspace, which may be expected to contain some local minima in general high-dimensional cases. [REF]) Convergence criteria were set as .... Running in parallel on 28 cores of an AMD Threadripper XXXX based workstation, this required ~5GB of RAM and took ~1 hour; further benchmarks for the current codebase can be found at [REF].

Results are summarised in Figs. XX. A few conclusions from this case study:

\begin{enumerate}
\item Not all fits that converged - as defined by the criteria above - provided the reference matrix elements. This illustrates the importance of statistical sample of the solution hyperspace, and/or the use of further tests of the fit results [REF] in order to determine their veracity in general.
\item In this case, the lowest $\chi^2$ does correspond to the reference matrix elements
\end{enumerate}

TO CONSIDER:

- Level of detail here, words vs. just pointing at the notebook.